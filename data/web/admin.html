<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
  <title>RED808 ‚Äî Admin</title>
  <link rel="stylesheet" href="admin.css">
</head>
<body>
<div id="adm">

  <!-- ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ -->
  <header id="admHeader">
    <div class="adm-logo">
      <span class="adm-logo-r">R</span><span class="adm-logo-e">E</span><span class="adm-logo-d">D</span>
      <span class="adm-logo-808">808</span>
      <span class="adm-logo-tag">ADMIN</span>
    </div>
    <nav class="adm-nav">
      <a href="/" class="adm-nav-btn">üéõ MAIN</a>
      <a href="/patchbay" class="adm-nav-btn">‚¨° PATCHBAY</a>
      <a href="/multiview" class="adm-nav-btn">‚äû MULTIVIEW</a>
    </nav>
    <div class="adm-status-wrap">
      <div id="admWsBadge" class="adm-badge badge-warn">‚óè WS‚Ä¶</div>
      <div id="admSyncBadge" class="adm-badge badge-dim">‚Ü∫ --s</div>
    </div>
  </header>

  <!-- ‚îÄ‚îÄ TOP STATS BAR ‚îÄ‚îÄ -->
  <section id="admStats">
    <div class="stat-card" id="stat-heap">
      <div class="stat-label">HEAP FREE</div>
      <div class="stat-value" id="sv-heap">--</div>
      <div class="stat-sub" id="ss-heap">of --</div>
    </div>
    <div class="stat-card" id="stat-psram">
      <div class="stat-label">PSRAM FREE</div>
      <div class="stat-value" id="sv-psram">--</div>
      <div class="stat-sub" id="ss-psram">of --</div>
    </div>
    <div class="stat-card" id="stat-samples">
      <div class="stat-label">SAMPLES</div>
      <div class="stat-value" id="sv-samples">--</div>
      <div class="stat-sub" id="ss-samples">-- MB RAM</div>
    </div>
    <div class="stat-card" id="stat-bpm">
      <div class="stat-label">TEMPO</div>
      <div class="stat-value" id="sv-bpm">--</div>
      <div class="stat-sub" id="ss-bpm">BPM</div>
    </div>
    <div class="stat-card" id="stat-uptime">
      <div class="stat-label">UPTIME</div>
      <div class="stat-value" id="sv-uptime">--</div>
      <div class="stat-sub" id="ss-uptime">hh:mm:ss</div>
    </div>
    <div class="stat-card" id="stat-clients">
      <div class="stat-label">CLIENTS</div>
      <div class="stat-value" id="sv-clients">--</div>
      <div class="stat-sub" id="ss-clients">WS / UDP</div>
    </div>
  </section>

  <!-- ‚îÄ‚îÄ MAIN GRID ‚îÄ‚îÄ -->
  <main id="admGrid">

    <!-- ‚îÄ‚îÄ SYSTEM INFO ‚îÄ‚îÄ -->
    <div class="adm-card" id="card-sysinfo">
      <div class="adm-card-head">
        <span class="adm-card-title">üíª SYSTEM</span>
        <button class="adm-hdr-btn" onclick="fetchSysinfo()">‚Ü∫</button>
      </div>
      <div class="adm-card-body">
        <table class="info-table">
          <tr><td>IP</td><td id="si-ip">--</td></tr>
          <tr><td>WiFi Channel</td><td id="si-ch">--</td></tr>
          <tr><td>TX Power</td><td id="si-tx">--</td></tr>
          <tr><td>Stations</td><td id="si-sta">--</td></tr>
          <tr><td>Flash Size</td><td id="si-flash">--</td></tr>
          <tr><td>Firmware</td><td id="si-fw">RED808 v2.0</td></tr>
        </table>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ MEMORY ‚îÄ‚îÄ -->
    <div class="adm-card" id="card-memory">
      <div class="adm-card-head">
        <span class="adm-card-title">üß† MEMORY</span>
      </div>
      <div class="adm-card-body">
        <div class="mem-row">
          <div class="mem-label">Heap</div>
          <div class="mem-bar-wrap"><div class="mem-bar heap" id="mb-heap"></div></div>
          <div class="mem-nums"><span id="mn-heap-used">--</span> / <span id="mn-heap-total">--</span></div>
        </div>
        <div class="mem-row">
          <div class="mem-label">PSRAM</div>
          <div class="mem-bar-wrap"><div class="mem-bar psram" id="mb-psram"></div></div>
          <div class="mem-nums"><span id="mn-psram-used">--</span> / <span id="mn-psram-total">--</span></div>
        </div>
        <div class="mem-row">
          <div class="mem-label">Samples</div>
          <div class="mem-bar-wrap"><div class="mem-bar samp" id="mb-samples"></div></div>
          <div class="mem-nums"><span id="mn-samples-used">--</span> used</div>
        </div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ DAISY SLAVE STATUS ‚îÄ‚îÄ -->
    <div class="adm-card" id="card-daisy">
      <div class="adm-card-head">
        <span class="adm-card-title">üéõ DAISY SLAVE</span>
        <div id="daisy-badge" class="adm-badge badge-warn">WAITING</div>
      </div>
      <div class="adm-card-body">
        <table class="info-table">
          <tr><td>SPI Connection</td><td id="ds-conn">--</td></tr>
          <tr><td>Last PING RTT</td><td id="ds-rtt">--</td></tr>
          <tr><td>Samples loaded</td><td id="ds-samples">--</td></tr>
          <tr><td>Active voices</td><td id="ds-voices">--</td></tr>
          <tr><td>Slave uptime</td><td id="ds-uptime">--</td></tr>
        </table>
        <div id="daisy-hint" class="daisy-hint">
          ‚åõ Esperando Daisy Seed‚Ä¶ ‚Üí D10‚ÜîGPIO12 ¬∑ D9‚ÜîGPIO11 ¬∑ D8‚ÜîGPIO13 ¬∑ D7‚ÜîGPIO10 ¬∑ GND
        </div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ SEQUENCER ‚îÄ‚îÄ -->
    <div class="adm-card" id="card-seq">
      <div class="adm-card-head">
        <span class="adm-card-title">üéµ SEQUENCER</span>
        <div class="seq-btns">
          <button class="adm-hdr-btn" onclick="admSendWS({cmd:'start'})">‚ñ∂</button>
          <button class="adm-hdr-btn" onclick="admSendWS({cmd:'stop'})">‚èπ</button>
        </div>
      </div>
      <div class="adm-card-body">
        <table class="info-table">
          <tr><td>Status</td><td><span id="seq-dot" class="seq-dot stopped"></span><span id="seq-status">STOPPED</span></td></tr>
          <tr><td>Tempo</td><td id="seq-bpm">-- BPM</td></tr>
          <tr><td>Pattern</td><td id="seq-pat">--</td></tr>
          <tr><td>Step</td><td id="seq-step">--</td></tr>
        </table>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ AUDIO PEAKS ‚îÄ‚îÄ -->
    <div class="adm-card" id="card-peaks">
      <div class="adm-card-head">
        <span class="adm-card-title">üîä AUDIO PEAKS</span>
        <div class="adm-badge badge-dim" id="peak-master-badge">MASTER --</div>
      </div>
      <div class="adm-card-body">
        <div id="peaksGrid" class="peaks-grid"><!-- generated by JS --></div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ WS CLIENTS ‚îÄ‚îÄ -->
    <div class="adm-card" id="card-ws">
      <div class="adm-card-head">
        <span class="adm-card-title">üîå WS CLIENTS <span class="adm-count" id="wc-count">0</span>/3</span>
      </div>
      <div class="adm-card-body" id="wc-body">
        <div class="empty-state">No hay clientes conectados</div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ UDP CLIENTS ‚îÄ‚îÄ -->
    <div class="adm-card" id="card-udp">
      <div class="adm-card-head">
        <span class="adm-card-title">üì° UDP CLIENTS <span class="adm-count" id="uc-count">0</span></span>
      </div>
      <div class="adm-card-body" id="uc-body">
        <div class="empty-state">No hay clientes UDP</div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ QUICK ACTIONS ‚îÄ‚îÄ -->
    <div class="adm-card" id="card-actions">
      <div class="adm-card-head">
        <span class="adm-card-title">‚ö° ACCIONES</span>
      </div>
      <div class="adm-card-body">
        <div class="actions-grid">
          <button class="act-btn accent" onclick="location.href='/'">üéõ Main UI</button>
          <button class="act-btn" onclick="admFetchRefreshAll()">‚Ü∫ Refresh</button>
          <button class="act-btn danger" onclick="admReboot()">‚èª Reboot</button>
          <button class="act-btn warn" onclick="admClearSamples()">üóë Clear samples</button>
          <button class="act-btn" onclick="admSendWS({cmd:'stop'})">‚èπ Stop seq</button>
          <button class="act-btn" id="autRefBtn" onclick="admToggleAutoRefresh()">‚è± Auto: ON</button>
        </div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ MEMORY CHART full width ‚îÄ‚îÄ -->
    <div class="adm-card full-width" id="card-chart">
      <div class="adm-card-head">
        <span class="adm-card-title">üìà MONITOR EN VIVO</span>
        <div class="chart-legend">
          <span class="leg heap">‚óè Heap</span>
          <span class="leg psram">‚óè PSRAM</span>
        </div>
      </div>
      <div class="adm-card-body chart-body">
        <canvas id="admChart"></canvas>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ LOG CONSOLE full width ‚îÄ‚îÄ -->
    <div class="adm-card full-width" id="card-log">
      <div class="adm-card-head">
        <span class="adm-card-title">üìã LOG EN VIVO</span>
        <div class="log-controls">
          <button class="adm-hdr-btn" onclick="admClearLog()">üóë</button>
          <label class="log-pause-label"><input type="checkbox" id="logPauseChk"> Pausar</label>
        </div>
      </div>
      <div class="adm-card-body log-body">
        <pre id="admLog"></pre>
      </div>
    </div>

  </main>
</div>

<script src="admin.js"></script>
</body>
</html>
