<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RED808 Drum Machine</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="keyboard-styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1 class="logo">RED<span>808</span></h1>
                <div class="status">
                    <span id="statusDot" class="status-dot"></span>
                    <span id="statusText">Conectando...</span>
                </div>
            </div>
            <div class="header-meters">
                <div class="meter" id="meter-bpm">
                    <span class="meter-label">BPM</span>
                    <span class="meter-hint">[ / ]</span>
                    <div class="meter-value" id="meterBpmValue">110</div>
                    <div class="meter-bar">
                        <span id="meterBpmBar"></span>
                    </div>
                </div>
                <div class="meter" id="meter-seq-volume">
                    <span class="meter-label">VOL SEQ</span>
                    <span class="meter-hint">A / S</span>
                    <div class="meter-value" id="meterSequencerVolumeValue">100%</div>
                    <div class="meter-bar">
                        <span id="meterSequencerVolumeBar"></span>
                    </div>
                </div>
                <div class="meter" id="meter-live-volume">
                    <span class="meter-label">VOL LIVE</span>
                    <span class="meter-hint">- / +</span>
                    <div class="meter-value" id="meterLiveVolumeValue">100%</div>
                    <div class="meter-bar">
                        <span id="meterLiveVolumeBar"></span>
                    </div>
                </div>
                <div class="meter meter-sequencer" id="meter-sequencer">
                    <span class="meter-label">SQNCR</span>
                    <div class="meter-value" id="meterSequencerStatus">STOP</div>
                    <div class="meter-bar">
                        <span id="meterSequencerStatusBar"></span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Tab Navigation Bar -->
        <nav class="tab-navigation">
            <button class="tab-btn active" data-tab="performance">üéπ LIVE</button>
            <button class="tab-btn" data-tab="sequencer">üéµ SEQUENCER</button>
            <button class="tab-btn" data-tab="controls">üéõÔ∏è CONTROLES</button>
            <button class="tab-btn" data-tab="volumes">üéöÔ∏è VOLUMENES</button>
            <button class="tab-btn" data-tab="fx">üîä FX</button>
            <button class="tab-btn" data-tab="midi">üéπ MIDI</button>
            <button class="tab-btn" data-tab="info">üìä INFO</button>
        </nav>

        <!-- TAB: Performance (Live Pads + Visualizer) -->
        <div id="tab-performance" class="tab-content active">
            <!-- Live Pads Section -->
            <section id="section-pads" class="pads-section" data-section="pads" data-title="Live Pads">
                <div class="pads-header">
                    <h2>LIVE PADS</h2>
                    <button id="loadSampleListsBtn" class="btn btn-load-samples" title="Recargar Samplers">
                        üîÑ
                    </button>
                </div>
                <div class="pads-grid" id="padsGrid">
                    <!-- Los pads se generar√°n din√°micamente -->
                </div>
            </section>

            <!-- Audio Visualizer Section - DESACTIVADO -->
            <!-- <section id="section-visualizer" class="visualizer-section" data-section="visualizer" data-title="Audio Visualizer">
                <div class="visualizer-grid">
                    <div class="visualizer-panel visualizer-full">
                        <h3>SPECTRUM ANALYZER</h3>
                        <canvas id="spectrumCanvas" width="600" height="200"></canvas>
                    </div>
                </div>
            </section> -->
        </div>

        <!-- TAB: Sequencer -->
        <div id="tab-sequencer" class="tab-content">
            <!-- Sequencer Section -->
            <section id="section-sequencer" class="sequencer-section" data-section="sequencer" data-title="Sequencer">
                <div class="sequencer-header">
                    <div class="sequencer-controls">
                        <button id="playBtn" class="seq-btn seq-btn-play" title="Play/Pause">
                            <span class="seq-btn-bg"></span>
                            <span class="seq-btn-icon">‚ñ∂</span>
                            <span class="seq-btn-label">PLAY</span>
                        </button>
                        <button id="stopBtn" class="seq-btn seq-btn-stop" title="Stop">
                            <span class="seq-btn-bg"></span>
                            <span class="seq-btn-icon">‚¨õ</span>
                            <span class="seq-btn-label">STOP</span>
                        </button>
                        <button id="clearBtn" class="seq-btn seq-btn-clear" title="Clear Pattern">
                            <span class="seq-btn-bg"></span>
                            <span class="seq-btn-icon">‚ö°</span>
                            <span class="seq-btn-label">CLEAR</span>
                        </button>
                        <button id="viewModeBtn" class="seq-btn seq-btn-view-mode" title="Cambiar vista: Grid / Circular">
                            <span class="seq-btn-bg"></span>
                            <span class="seq-btn-icon">‚≠ò</span>
                            <span class="seq-btn-label">CIRCULAR</span>
                        </button>
                        <div class="pattern-display">
                            <span class="pattern-label">PATTERN</span>
                            <span id="currentPatternName" class="pattern-name">HIP HOP</span>
                        </div>
                    </div>
                </div>
                
                <div class="sequencer-grid-wrapper" id="sequencerContainer">
                    <div class="sequencer-grid" id="sequencerGrid">
                        <!-- 16 tracks x 16 steps -->
                    </div>
                    
                    <div class="step-indicator" id="stepIndicator">
                        <!-- Indicador de step actual -->
                    </div>
                </div>
                
                <div class="sequencer-circular-wrapper hidden" id="sequencerCircularContainer">
                    <div class="circular-sequencer" id="circularSequencer">
                        <canvas id="circularCanvas"></canvas>
                        <div class="circular-center-display">
                            <div class="circular-step-number" id="circularStepNumber">1</div>
                            <div class="circular-pattern-name" id="circularPatternName">HIP HOP</div>
                        </div>
                        <div class="circular-track-labels" id="circularTrackLabels">
                            <!-- Track labels din√°micos -->
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- TAB: Controls -->
        <div id="tab-controls" class="tab-content">
            <!-- Controls Section -->
            <section id="section-controls" class="controls-section" data-section="controls" data-title="Controls">
                <div class="control-group">
                    <label for="tempoSlider">TEMPO: <span id="tempoValue">110</span> BPM</label>
                    <input type="range" id="tempoSlider" min="60" max="200" value="110" class="slider">
                </div>
                
                <div class="control-group">
                    <label for="sequencerVolumeSlider">VOLUMEN SEQUENCER: <span id="sequencerVolumeValue">100</span>%</label>
                    <input type="range" id="sequencerVolumeSlider" min="0" max="150" value="100" class="slider">
                </div>

                <div class="control-group">
                    <label for="liveVolumeSlider">VOLUMEN LIVE PADS: <span id="liveVolumeValue">100</span>%</label>
                    <input type="range" id="liveVolumeSlider" min="0" max="150" value="100" class="slider">
                </div>
                
                <div class="control-group">
                    <label>PATTERN:</label>
                    <div class="pattern-buttons">
                        <button class="btn-pattern active" data-pattern="0">HIP HOP</button>
                        <button class="btn-pattern" data-pattern="1">TECHNO</button>
                        <button class="btn-pattern" data-pattern="2">DnB</button>
                        <button class="btn-pattern" data-pattern="3">BREAK</button>
                        <button class="btn-pattern" data-pattern="4">HOUSE</button>
                        <button class="btn-pattern" data-pattern="5">TRAP</button>
                    </div>
                </div>
                
                <div class="control-group">
                    <button id="colorToggle" class="btn-color-toggle">üé® COLOR MODE</button>
                </div>
            </section>


        </div>

        <!-- TAB: Volumes -->
        <div id="tab-volumes" class="tab-content">
            <!-- Volumes Section -->
            <section id="section-volumes" class="volumes-section" data-section="volumes" data-title="Controles de Volumen">
                <div class="volumes-header">
                    <h2>üéöÔ∏è CONTROLES DE VOLUMEN</h2>
                    <p class="volumes-description">Control individual de vol√∫menes en tiempo real</p>
                </div>

                <!-- Master Volumes -->
                <div class="master-volumes">
                    <div class="volume-card sequencer-volume">
                        <div class="volume-card-header">
                            <span class="volume-icon">üéµ</span>
                            <h3>VOLUMEN SEQUENCER</h3>
                        </div>
                        <div class="volume-display">
                            <div class="volume-value-display" id="displaySequencerVolume">100%</div>
                            <div class="volume-bar-container">
                                <div class="volume-bar sequencer" id="barSequencerVolume" style="width: 100%;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="volume-card pads-volume">
                        <div class="volume-card-header">
                            <span class="volume-icon">üéπ</span>
                            <h3>VOLUMEN PADS</h3>
                        </div>
                        <div class="volume-display">
                            <div class="volume-value-display" id="displayPadsVolume">100%</div>
                            <div class="volume-bar-container">
                                <div class="volume-bar pads" id="barPadsVolume" style="width: 100%;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Track Volumes -->
                <div class="track-volumes">
                    <h3 class="track-volumes-title">VOLUMENES DE TRACKS</h3>
                    <div class="track-volumes-grid" id="trackVolumesGrid">
                        <!-- Track 0: BD -->
                        <div class="track-volume-card" data-track="0">
                            <div class="track-volume-header">
                                <span class="track-volume-label">BD</span>
                                <span class="track-volume-value" id="trackVolumeValue0">100%</span>
                                <span class="track-volume-mute-indicator" id="trackMuteIndicator0"></span>
                            </div>
                            <div class="track-volume-bar-container">
                                <div class="track-volume-bar" id="trackVolumeBar0" data-track="0" style="width: 100%;"></div>
                            </div>
                        </div>
                        <!-- Track 1: SD -->
                        <div class="track-volume-card" data-track="1">
                            <div class="track-volume-header">
                                <span class="track-volume-label">SD</span>
                                <span class="track-volume-value" id="trackVolumeValue1">100%</span>
                                <span class="track-volume-mute-indicator" id="trackMuteIndicator1"></span>
                            </div>
                            <div class="track-volume-bar-container">
                                <div class="track-volume-bar" id="trackVolumeBar1" data-track="1" style="width: 100%;"></div>
                            </div>
                        </div>
                        <!-- Track 2: CH -->
                        <div class="track-volume-card" data-track="2">
                            <div class="track-volume-header">
                                <span class="track-volume-label">CH</span>
                                <span class="track-volume-value" id="trackVolumeValue2">100%</span>
                                <span class="track-volume-mute-indicator" id="trackMuteIndicator2"></span>
                            </div>
                            <div class="track-volume-bar-container">
                                <div class="track-volume-bar" id="trackVolumeBar2" data-track="2" style="width: 100%;"></div>
                            </div>
                        </div>
                        <!-- Track 3: OH -->
                        <div class="track-volume-card" data-track="3">
                            <div class="track-volume-header">
                                <span class="track-volume-label">OH</span>
                                <span class="track-volume-value" id="trackVolumeValue3">100%</span>
                                <span class="track-volume-mute-indicator" id="trackMuteIndicator3"></span>
                            </div>
                            <div class="track-volume-bar-container">
                                <div class="track-volume-bar" id="trackVolumeBar3" data-track="3" style="width: 100%;"></div>
                            </div>
                        </div>
                        <!-- Track 4: CP -->
                        <div class="track-volume-card" data-track="4">
                            <div class="track-volume-header">
                                <span class="track-volume-label">CP</span>
                                <span class="track-volume-value" id="trackVolumeValue4">100%</span>
                                <span class="track-volume-mute-indicator" id="trackMuteIndicator4"></span>
                            </div>
                            <div class="track-volume-bar-container">
                                <div class="track-volume-bar" id="trackVolumeBar4" data-track="4" style="width: 100%;"></div>
                            </div>
                        </div>
                        <!-- Track 5: RS -->
                        <div class="track-volume-card" data-track="5">
                            <div class="track-volume-header">
                                <span class="track-volume-label">RS</span>
                                <span class="track-volume-value" id="trackVolumeValue5">100%</span>
                                <span class="track-volume-mute-indicator" id="trackMuteIndicator5"></span>
                            </div>
                            <div class="track-volume-bar-container">
                                <div class="track-volume-bar" id="trackVolumeBar5" data-track="5" style="width: 100%;"></div>
                            </div>
                        </div>
                        <!-- Track 6: CL -->
                        <div class="track-volume-card" data-track="6">
                            <div class="track-volume-header">
                                <span class="track-volume-label">CL</span>
                                <span class="track-volume-value" id="trackVolumeValue6">100%</span>
                                <span class="track-volume-mute-indicator" id="trackMuteIndicator6"></span>
                            </div>
                            <div class="track-volume-bar-container">
                                <div class="track-volume-bar" id="trackVolumeBar6" data-track="6" style="width: 100%;"></div>
                            </div>
                        </div>
                        <!-- Track 7: CY -->
                        <div class="track-volume-card" data-track="7">
                            <div class="track-volume-header">
                                <span class="track-volume-label">CY</span>
                                <span class="track-volume-value" id="trackVolumeValue7">100%</span>
                                <span class="track-volume-mute-indicator" id="trackMuteIndicator7"></span>
                            </div>
                            <div class="track-volume-bar-container">
                                <div class="track-volume-bar" id="trackVolumeBar7" data-track="7" style="width: 100%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- TAB: FX -->
        <div id="tab-fx" class="tab-content">
            <!-- FX Section -->
            <section id="section-fx" class="fx-section" data-section="fx" data-title="Sound FX">
                <h2>üéõÔ∏è FILTROS & EFECTOS</h2>
                
                <!-- Filter Library with presets -->
                <div class="filter-library">
                    <h3>üìö BIBLIOTECA DE FILTROS</h3>
                    <p class="filter-description">Selecciona un filtro para track o pad. Usa F1-F10 (track) o Shift+F1-F10 (pad).</p>
                    
                    <div class="filters-grid">
                        <!-- 0: NONE -->
                        <div class="filter-card" data-filter="0">
                            <div class="filter-header">
                                <span class="filter-icon">‚≠ï</span>
                                <span class="filter-title">NONE</span>
                                <span class="filter-key">F1</span>
                            </div>
                            <p class="filter-desc">Sin filtro. Sonido original sin procesamiento.</p>
                        </div>
                        
                        <!-- 1: LOW PASS -->
                        <div class="filter-card" data-filter="1">
                            <div class="filter-header">
                                <span class="filter-icon">üîΩ</span>
                                <span class="filter-title">LOW PASS</span>
                                <span class="filter-key">F2</span>
                            </div>
                            <p class="filter-desc">Elimina frecuencias altas. Sonido m√°s suave y oscuro.</p>
                            <div class="filter-presets">
                                <button onclick="applyFilterPreset(1, 500)" class="preset-btn">Dark (500Hz)</button>
                                <button onclick="applyFilterPreset(1, 1500)" class="preset-btn">Warm (1.5kHz)</button>
                                <button onclick="applyFilterPreset(1, 5000)" class="preset-btn">Natural (5kHz)</button>
                            </div>
                        </div>
                        
                        <!-- 2: HIGH PASS -->
                        <div class="filter-card" data-filter="2">
                            <div class="filter-header">
                                <span class="filter-icon">üîº</span>
                                <span class="filter-title">HIGH PASS</span>
                                <span class="filter-key">F3</span>
                            </div>
                            <p class="filter-desc">Elimina frecuencias bajas. Sonido m√°s brillante y delgado.</p>
                            <div class="filter-presets">
                                <button onclick="applyFilterPreset(2, 100)" class="preset-btn">Subtle (100Hz)</button>
                                <button onclick="applyFilterPreset(2, 400)" class="preset-btn">Thin (400Hz)</button>
                                <button onclick="applyFilterPreset(2, 1000)" class="preset-btn">Air (1kHz)</button>
                            </div>
                        </div>
                        
                        <!-- 3: BAND PASS -->
                        <div class="filter-card" data-filter="3">
                            <div class="filter-header">
                                <span class="filter-icon">üéØ</span>
                                <span class="filter-title">BAND PASS</span>
                                <span class="filter-key">F4</span>
                            </div>
                            <p class="filter-desc">Solo deja pasar un rango de frecuencias. Efecto "tel√©fono".</p>
                            <div class="filter-presets">
                                <button onclick="applyFilterPreset(3, 800)" class="preset-btn">Lo-Fi (800Hz)</button>
                                <button onclick="applyFilterPreset(3, 2000)" class="preset-btn">Radio (2kHz)</button>
                                <button onclick="applyFilterPreset(3, 4000)" class="preset-btn">Vocal (4kHz)</button>
                            </div>
                        </div>
                        
                        <!-- 4: NOTCH -->
                        <div class="filter-card" data-filter="4">
                            <div class="filter-header">
                                <span class="filter-icon">üö´</span>
                                <span class="filter-title">NOTCH</span>
                                <span class="filter-key">F5</span>
                            </div>
                            <p class="filter-desc">Elimina frecuencias espec√≠ficas. √ötil para remover resonancias.</p>
                            <div class="filter-presets">
                                <button onclick="applyFilterPreset(4, 1000)" class="preset-btn">Cut 1kHz</button>
                                <button onclick="applyFilterPreset(4, 3000)" class="preset-btn">Cut 3kHz</button>
                                <button onclick="applyFilterPreset(4, 8000)" class="preset-btn">Cut 8kHz</button>
                            </div>
                        </div>
                        
                        <!-- 5: LOW SHELF -->
                        <div class="filter-card" data-filter="5">
                            <div class="filter-header">
                                <span class="filter-icon">üìä</span>
                                <span class="filter-title">LOW SHELF</span>
                                <span class="filter-key">F6</span>
                            </div>
                            <p class="filter-desc">Aumenta o reduce graves por debajo de frecuencia. EQ de bajos.</p>
                            <div class="filter-presets">
                                <button onclick="applyFilterPreset(5, 100)" class="preset-btn">Bass (100Hz)</button>
                                <button onclick="applyFilterPreset(5, 300)" class="preset-btn">Low-Mid (300Hz)</button>
                                <button onclick="applyFilterPreset(5, 800)" class="preset-btn">Body (800Hz)</button>
                            </div>
                        </div>
                        
                        <!-- 6: HIGH SHELF -->
                        <div class="filter-card" data-filter="6">
                            <div class="filter-header">
                                <span class="filter-icon">üìà</span>
                                <span class="filter-title">HIGH SHELF</span>
                                <span class="filter-key">F7</span>
                            </div>
                            <p class="filter-desc">Aumenta o reduce agudos por encima de frecuencia. EQ de altos.</p>
                            <div class="filter-presets">
                                <button onclick="applyFilterPreset(6, 5000)" class="preset-btn">Presence (5kHz)</button>
                                <button onclick="applyFilterPreset(6, 8000)" class="preset-btn">Bright (8kHz)</button>
                                <button onclick="applyFilterPreset(6, 12000)" class="preset-btn">Air (12kHz)</button>
                            </div>
                        </div>
                        
                        <!-- 7: PEAK -->
                        <div class="filter-card" data-filter="7">
                            <div class="filter-header">
                                <span class="filter-icon">‚õ∞Ô∏è</span>
                                <span class="filter-title">PEAK</span>
                                <span class="filter-key">F8</span>
                            </div>
                            <p class="filter-desc">Realza frecuencia espec√≠fica. Perfecto para resonancia y car√°cter.</p>
                            <div class="filter-presets">
                                <button onclick="applyFilterPreset(7, 1000)" class="preset-btn">Punch (1kHz)</button>
                                <button onclick="applyFilterPreset(7, 3000)" class="preset-btn">Snappy (3kHz)</button>
                                <button onclick="applyFilterPreset(7, 6000)" class="preset-btn">Crispy (6kHz)</button>
                            </div>
                        </div>
                        
                        <!-- 8: ALL PASS -->
                        <div class="filter-card" data-filter="8">
                            <div class="filter-header">
                                <span class="filter-icon">üåÄ</span>
                                <span class="filter-title">ALL PASS</span>
                                <span class="filter-key">F9</span>
                            </div>
                            <p class="filter-desc">Cambia fase sin alterar volumen. Efecto phaser/comb.</p>
                            <div class="filter-presets">
                                <button onclick="applyFilterPreset(8, 500)" class="preset-btn">Phaser (500Hz)</button>
                                <button onclick="applyFilterPreset(8, 2000)" class="preset-btn">Comb (2kHz)</button>
                                <button onclick="applyFilterPreset(8, 8000)" class="preset-btn">Subtle (8kHz)</button>
                            </div>
                        </div>
                        
                        <!-- 9: RESONANT -->
                        <div class="filter-card" data-filter="9">
                            <div class="filter-header">
                                <span class="filter-icon">üí´</span>
                                <span class="filter-title">RESONANT</span>
                                <span class="filter-key">F10</span>
                            </div>
                            <p class="filter-desc">Filtro con resonancia extrema. Sonido sint√©tico y met√°lico.</p>
                            <div class="filter-presets">
                                <button onclick="applyFilterPreset(9, 400)" class="preset-btn">Deep (400Hz)</button>
                                <button onclick="applyFilterPreset(9, 1500)" class="preset-btn">Classic (1.5kHz)</button>
                                <button onclick="applyFilterPreset(9, 4000)" class="preset-btn">Acid (4kHz)</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Active Filters Display -->
                <div class="active-filters-section">
                    <h3>‚ú® FILTROS ACTIVOS</h3>
                    <div class="active-filters-display">
                        <div class="active-filter-group">
                            <h4>üéµ TRACKS (F1-F10)</h4>
                            <div id="activeTrackFilters" class="active-filter-list">
                                <span class="no-filters">Ning√∫n filtro aplicado a tracks</span>
                            </div>
                        </div>
                        <div class="active-filter-group">
                            <h4>üéπ PADS (Shift+F1-F10)</h4>
                            <div id="activePadFilters" class="active-filter-list">
                                <span class="no-filters">Ning√∫n filtro aplicado a pads</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Reference -->
                <div class="filter-reference">
                    <h4>‚å®Ô∏è GU√çA R√ÅPIDA</h4>
                    <div class="reference-grid">
                        <div class="reference-item">
                            <strong>Filtro a Track:</strong>
                            <p>1. Click en nombre track (BD, SD, etc.)<br>2. Presiona F1-F10</p>
                        </div>
                        <div class="reference-item">
                            <strong>Filtro a Pad:</strong>
                            <p>1. Click en pad en secci√≥n LIVE<br>2. Presiona Shift+F1-F10</p>
                        </div>
                        <div class="reference-item">
                            <strong>Presets R√°pidos:</strong>
                            <p>Click en botones de presets<br>para aplicar frecuencias t√≠picas</p>
                        </div>
                        <div class="reference-item">
                            <strong>Ver Activos:</strong>
                            <p>Los filtros activos se muestran<br>con badges en pads y tracks</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- TAB: MIDI -->
        <div id="tab-midi" class="tab-content">
            <section id="section-midi" class="midi-section" data-section="midi" data-title="MIDI Control">
                
                <!-- MIDI Dashboard Header -->
                <div class="midi-dashboard-header">
                    <div class="midi-title-group">
                        <h2>üéπ MIDI USB DASHBOARD</h2>
                        <div class="midi-connection-badge" id="midiConnectionBadge">
                            <span class="badge-dot"></span>
                            <span class="badge-text">Desconectado</span>
                        </div>
                    </div>
                </div>

                <!-- Stats Overview -->
                <div class="midi-stats-row">
                    <div class="stat-card">
                        <div class="stat-icon">üéµ</div>
                        <div class="stat-content">
                            <div class="stat-value" id="midiTotalNotes">0</div>
                            <div class="stat-label">Notas MIDI</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚ö°</div>
                        <div class="stat-content">
                            <div class="stat-value" id="midiAvgVelocity">‚Äî</div>
                            <div class="stat-label">Velocity Media</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üéõÔ∏è</div>
                        <div class="stat-content">
                            <div class="stat-value" id="midiCCMessages">0</div>
                            <div class="stat-label">CC Messages</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è±Ô∏è</div>
                        <div class="stat-content">
                            <div class="stat-value" id="midiUptime">00:00</div>
                            <div class="stat-label">Tiempo Activo</div>
                        </div>
                    </div>
                </div>

                <!-- Main Dashboard Grid -->
                <div class="midi-dashboard-grid">
                    
                    <!-- Left Column: Device Info & Mapping -->
                    <div class="midi-left-column">
                        
                        <!-- Device Info Card -->
                        <div class="dashboard-card device-info-card" id="midiDeviceCard">
                            <div class="card-header">
                                <h3><span class="card-icon">üîå</span> Dispositivo Conectado</h3>
                                <div class="signal-indicator">
                                    <span class="signal-bar"></span>
                                    <span class="signal-bar"></span>
                                    <span class="signal-bar"></span>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="device-detail">
                                    <span class="detail-label">Dispositivo:</span>
                                    <span class="detail-value" id="midiDeviceName">Esperando conexi√≥n...</span>
                                </div>
                                <div class="device-detail">
                                    <span class="detail-label">Vendor ID:</span>
                                    <span class="detail-value" id="midiVendorId">‚Äî</span>
                                </div>
                                <div class="device-detail">
                                    <span class="detail-label">Product ID:</span>
                                    <span class="detail-value" id="midiProductId">‚Äî</span>
                                </div>
                                <div class="device-detail">
                                    <span class="detail-label">Puerto USB:</span>
                                    <span class="detail-value">OTG (GPIO 19/20)</span>
                                </div>
                            </div>
                        </div>

                        <!-- MIDI Mapping Card -->
                        <div class="dashboard-card mapping-card">
                            <div class="card-header">
                                <h3><span class="card-icon">üó∫Ô∏è</span> Note Mapping</h3>
                                <div class="mapping-controls">
                                    <button class="mapping-btn" id="editMappingBtn" onclick="toggleMappingEdit()">‚úèÔ∏è Editar</button>
                                    <button class="mapping-btn secondary" id="resetMappingBtn" onclick="resetMIDIMapping()" style="display:none;">üîÑ Reset</button>
                                    <button class="mapping-btn primary" id="saveMappingBtn" onclick="saveMIDIMapping()" style="display:none;">üíæ Guardar</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="mapping-grid" id="mappingGrid">
                                    <div class="mapping-item" data-pad="0" data-note="36">
                                        <span class="note-badge editable" contenteditable="false">36</span>
                                        <span class="note-name">C1</span>
                                        <span class="pad-target">BD</span>
                                        <div class="velocity-bar"><div class="velocity-fill"></div></div>
                                    </div>
                                    <div class="mapping-item" data-pad="1" data-note="37">
                                        <span class="note-badge editable" contenteditable="false">37</span>
                                        <span class="note-name">C#1</span>
                                        <span class="pad-target">SD</span>
                                        <div class="velocity-bar"><div class="velocity-fill"></div></div>
                                    </div>
                                    <div class="mapping-item" data-pad="2" data-note="38">
                                        <span class="note-badge editable" contenteditable="false">38</span>
                                        <span class="note-name">D1</span>
                                        <span class="pad-target">CH</span>
                                        <div class="velocity-bar"><div class="velocity-fill"></div></div>
                                    </div>
                                    <div class="mapping-item" data-pad="3" data-note="39">
                                        <span class="note-badge editable" contenteditable="false">39</span>
                                        <span class="note-name">D#1</span>
                                        <span class="pad-target">OH</span>
                                        <div class="velocity-bar"><div class="velocity-fill"></div></div>
                                    </div>
                                    <div class="mapping-item" data-pad="4" data-note="40">
                                        <span class="note-badge editable" contenteditable="false">40</span>
                                        <span class="note-name">E1</span>
                                        <span class="pad-target">CP</span>
                                        <div class="velocity-bar"><div class="velocity-fill"></div></div>
                                    </div>
                                    <div class="mapping-item" data-pad="5" data-note="41">
                                        <span class="note-badge editable" contenteditable="false">41</span>
                                        <span class="note-name">F1</span>
                                        <span class="pad-target">RS</span>
                                        <div class="velocity-bar"><div class="velocity-fill"></div></div>
                                    </div>
                                    <div class="mapping-item" data-pad="6" data-note="42">
                                        <span class="note-badge editable" contenteditable="false">42</span>
                                        <span class="note-name">F#1</span>
                                        <span class="pad-target">CL</span>
                                        <div class="velocity-bar"><div class="velocity-fill"></div></div>
                                    </div>
                                    <div class="mapping-item" data-pad="7" data-note="43">
                                        <span class="note-badge editable" contenteditable="false">43</span>
                                        <span class="note-name">G1</span>
                                        <span class="pad-target">CB</span>
                                        <div class="velocity-bar"><div class="velocity-fill"></div></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Live Monitor -->
                    <div class="midi-right-column">
                        <div class="dashboard-card monitor-card">
                            <div class="card-header">
                                <h3><span class="card-icon">üì°</span> Monitor en Tiempo Real</h3>
                                <button class="clear-monitor-btn" id="clearMidiMonitor">üóëÔ∏è Limpiar</button>
                            </div>
                            <div class="card-body">
                                <div class="monitor-display" id="midiMonitor">
                                    <div class="monitor-placeholder">
                                        <div class="placeholder-icon">üéπ</div>
                                        <div class="placeholder-text">Esperando mensajes MIDI...</div>
                                        <div class="placeholder-hint">Conecta un dispositivo y toca algunas notas</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </section>
        </div>

        <!-- TAB: Info (Device + Instruments) -->
        <div id="tab-info" class="tab-content">
            <!-- Device Info Section -->
            <section id="section-device" class="device-info" data-section="device" data-title="Device Info">
                <div class="info-title">üéõÔ∏è DEVICE + LIBRARY</div>
                <div style="margin-bottom: 10px;">
                    <button id="reloadCountsBtn" class="btn" style="background: #00aa00; padding: 6px 12px; font-size: 0.9em;">üîÑ RECARGAR CONTEOS</button>
                </div>
                <div class="device-cards">
                    <div class="info-card emphasis">
                        <span class="info-label">Samples Loaded</span>
                        <span class="info-value" id="samplesCount">0</span>
                        <span class="info-sub" id="libraryTotals">0 files / 0 families</span>
                    </div>
                    <div class="info-card">
                        <span class="info-label">Memory Used</span>
                        <span class="info-value" id="memoryUsed">0 MB</span>
                        <span class="info-sub" id="psramFree">PSRAM free ‚Äî</span>
                    </div>
                    <div class="info-card">
                        <span class="info-label">Sample Format</span>
                        <span class="info-value" id="sampleFormat">44.1kHz Mono 16-bit</span>
                        <span class="info-sub">Renderer locked @ 16 voices</span>
                    </div>
                </div>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Sampler:</span>
                        <span class="info-value">ESP32-S3 @ 240MHz (PSRAM)</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Polyphony:</span>
                        <span class="info-value">16 voices</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Tracks:</span>
                        <span class="info-value" id="tracksInfo">16 tracks x 16 steps</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Visualizer:</span>
                        <span class="info-value">32-band spectrum</span>
                    </div>
                </div>
            </section>

            <!-- Instruments Info Section -->
        <section id="section-instruments" class="device-info" data-section="instruments" data-title="Instrument Map">
            <div class="info-title">ü•Å INSTRUMENT MAP (16 TRACKS)</div>
            <div class="instrument-tabs">
                <button class="instrument-tab active" data-tab="active">ACTIVOS</button>
                <button class="instrument-tab" data-tab="all">TODOS</button>
            </div>
            <div class="instrument-panel active" data-panel="active">
                <div class="instrument-grid">
                <div class="instrument-card" data-family="BD">
                    <div class="inst-main">
                        <span class="inst-code">BD</span>
                        <div>
                            <div class="inst-name">Bass Drum (Bombo)</div>
                            <div class="inst-count" id="instCount-BD">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-BD">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-BD">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="SD">
                    <div class="inst-main">
                        <span class="inst-code">SD</span>
                        <div>
                            <div class="inst-name">Snare Drum (Caja)</div>
                            <div class="inst-count" id="instCount-SD">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-SD">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-SD">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="CH">
                    <div class="inst-main">
                        <span class="inst-code">CH</span>
                        <div>
                            <div class="inst-name">Closed Hi-Hat</div>
                            <div class="inst-count" id="instCount-CH">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-CH">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-CH">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="OH">
                    <div class="inst-main">
                        <span class="inst-code">OH</span>
                        <div>
                            <div class="inst-name">Open Hi-Hat</div>
                            <div class="inst-count" id="instCount-OH">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-OH">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-OH">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="CP">
                    <div class="inst-main">
                        <span class="inst-code">CP</span>
                        <div>
                            <div class="inst-name">Hand Clap (Palmas)</div>
                            <div class="inst-count" id="instCount-CP">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-CP">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-CP">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="CB">
                    <div class="inst-main">
                        <span class="inst-code">CB</span>
                        <div>
                            <div class="inst-name">Cowbell (Cencerro)</div>
                            <div class="inst-count" id="instCount-CB">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-CB">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-CB">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="RS">
                    <div class="inst-main">
                        <span class="inst-code">RS</span>
                        <div>
                            <div class="inst-name">Rim Shot (Aro)</div>
                            <div class="inst-count" id="instCount-RS">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-RS">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-RS">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="CL">
                    <div class="inst-main">
                        <span class="inst-code">CL</span>
                        <div>
                            <div class="inst-name">Claves</div>
                            <div class="inst-count" id="instCount-CL">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-CL">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-CL">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="MA">
                    <div class="inst-main">
                        <span class="inst-code">MA</span>
                        <div>
                            <div class="inst-name">Maracas</div>
                            <div class="inst-count" id="instCount-MA">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-MA">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-MA">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="CY">
                    <div class="inst-main">
                        <span class="inst-code">CY</span>
                        <div>
                            <div class="inst-name">Cymbal (Platillo)</div>
                            <div class="inst-count" id="instCount-CY">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-CY">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-CY">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="HT">
                    <div class="inst-main">
                        <span class="inst-code">HT</span>
                        <div>
                            <div class="inst-name">Hi Tom (Agudo)</div>
                            <div class="inst-count" id="instCount-HT">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-HT">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-HT">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="LT">
                    <div class="inst-main">
                        <span class="inst-code">LT</span>
                        <div>
                            <div class="inst-name">Low Tom (Grave)</div>
                            <div class="inst-count" id="instCount-LT">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-LT">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-LT">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="MC">
                    <div class="inst-main">
                        <span class="inst-code">MC</span>
                        <div>
                            <div class="inst-name">Mid Conga</div>
                            <div class="inst-count" id="instCount-MC">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-MC">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-MC">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="MT">
                    <div class="inst-main">
                        <span class="inst-code">MT</span>
                        <div>
                            <div class="inst-name">Mid Tom (Medio)</div>
                            <div class="inst-count" id="instCount-MT">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-MT">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-MT">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="HC">
                    <div class="inst-main">
                        <span class="inst-code">HC</span>
                        <div>
                            <div class="inst-name">Hi Conga</div>
                            <div class="inst-count" id="instCount-HC">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-HC">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-HC">Format: ‚Äî</span>
                    </div>
                </div>
                <div class="instrument-card" data-family="LC">
                    <div class="inst-main">
                        <span class="inst-code">LC</span>
                        <div>
                            <div class="inst-name">Low Conga</div>
                            <div class="inst-count" id="instCount-LC">‚Äî library files</div>
                        </div>
                    </div>
                    <div class="inst-meta">
                        <span class="inst-current" id="instCurrent-LC">Current: ‚Äî</span>
                        <span class="inst-quality" id="instQuality-LC">Format: ‚Äî</span>
                    </div>
                </div>
                </div>
            </div>
            <div class="instrument-panel" data-panel="all">
                <div class="sample-browser">
                    <div class="browser-header">
                        <div class="browser-title">üìö TODOS LOS SAMPLES</div>
                        <div class="sample-filters" id="sampleFilters"></div>
                    </div>
                    <div class="sample-filter-row">
                        <label class="sample-filter-label">ACTIVOS</label>
                        <label class="sample-toggle">
                            <input type="checkbox" id="sampleFilterActive">
                            <span class="sample-toggle-slider"></span>
                        </label>
                        <select id="sampleFilterFamily" class="sample-select"></select>
                        <select id="sampleFilterFormat" class="sample-select"></select>
                        <select id="sampleFilterRate" class="sample-select"></select>
                        <select id="sampleFilterChannels" class="sample-select"></select>
                    </div>
                    <div class="sample-browser-list" id="sampleBrowserList"></div>
                </div>
            </div>
        </section>
        </div>
        <!-- Fin de Tabs -->

        <!-- Footer -->
        <footer class="footer">
            <p>RED808 | 16-Track Drum Machine | ESP32-S3 Dual Core | <button onclick="showKeyboardHelp()" style="background:none;border:1px solid #00ff88;color:#00ff88;padding:5px 10px;border-radius:3px;cursor:pointer;">‚å®Ô∏è Keyboard Shortcuts</button></p>
        </footer>
    </div>

    <script src="app.js" defer></script>
    <script src="keyboard-controls.js" defer></script>
</body>
</html>
